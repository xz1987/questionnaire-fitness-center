<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Finger Lakes Fitness Center - Renovation Survey (Tablet Version)</title>
    <!-- This is the tablet-optimized version - if you see this, GitHub Pages is using the correct file -->
    <style>
        /* Minimal CSS - only for basic layout, all form elements use inline styles */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f5f5f5;
        }
        table {
            width: 100% !important;
            border-collapse: collapse !important;
            margin-bottom: 20px !important;
            background-color: #ffffff !important;
            display: table !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        td {
            padding: 10px !important;
            vertical-align: middle !important;
            display: table-cell !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        tr {
            display: table-row !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        input[type="radio"],
        input[type="checkbox"] {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            width: 28px !important;
            height: 28px !important;
        }
        label {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            color: #000000 !important;
        }
        h1 {
            text-align: center;
            color: #008B8B;
            font-size: 24px;
            margin: 10px 0;
        }
        h2 {
            color: #008B8B;
            font-size: 20px;
            margin: 20px 0 10px 0;
        }
        .section {
            background-color: #ffffff;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid #cccccc;
        }
        .submit-btn {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background-color: #008B8B;
            color: white;
            border: none;
            cursor: pointer;
            margin: 20px 0;
        }
        .error {
            color: red;
            font-size: 14px;
            display: none;
        }
        .error.show {
            display: block;
        }
        .success {
            color: green;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            margin: 10px 0;
            display: none;
        }
        .success.show {
            display: block;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 10px auto;
        }
    </style>
</head>
<body>
    <h1>FINGER LAKES FITNESS CENTER</h1>
    <h2 style="text-align: center; font-size: 18px; color: #666;">RENOVATION SURVEY</h2>
    <p style="text-align: center; color: #666; margin-bottom: 20px;">We appreciate your help!</p>

    <div class="section" style="background-color: #e8f4f4; padding: 15px; margin: 15px 0;">
        <h3 style="margin-top: 0; color: #008B8B;">Consent & Clarification Statement</h3>
        <p style="font-size: 14px; line-height: 1.6;">
            This survey is to better understand your wellness needs. Your feedback will help us enhance our facilities 
            and explore future development. By completing this survey, you confirm you've read and understood this information. 
            Participation is <strong>anonymous</strong> and <strong>voluntary</strong>; the survey takes about <strong>3-4 minutes</strong>.
        </p>
    </div>

    <form id="surveyForm" method="post" action="#">
        
        <!-- Section 1: Current Satisfaction Assessment -->
        <div class="section">
            <h2>Section 1: Current Satisfaction Assessment</h2>
            <p style="font-size: 16px; color: #666; margin-bottom: 15px;">
                Understanding Your Current Experience<br>
                Help us understand how well we're meeting your needs today.
            </p>

            <!-- Question 1: Overall Satisfaction -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        How satisfied are you with Finger Lakes Fitness Center overall? <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="overall_satisfaction" value="Very Dissatisfied" id="overall_1" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="overall_1" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Very Dissatisfied</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="overall_satisfaction" value="Dissatisfied" id="overall_2" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="overall_2" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Dissatisfied</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="overall_satisfaction" value="Neutral" id="overall_3" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="overall_3" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Neutral</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="overall_satisfaction" value="Satisfied" id="overall_4" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="overall_4" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Satisfied</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="overall_satisfaction" value="Very Satisfied" id="overall_5" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="overall_5" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Very Satisfied</label>
                    </td>
                </tr>
            </table>
            <div class="error" id="error_overall_satisfaction">Please select an option</div>

            <!-- Question 2: Top 3 Valued Factors -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        Please select your top 3 valued factors when choosing a fitness center <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Availability of personal trainers or classes" id="factor_1" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_1" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Availability of personal trainers or classes</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Ventilation, lighting, and air conditioning" id="factor_2" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_2" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Ventilation, lighting, and air conditioning</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Locker rooms and shower facilities" id="factor_3" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_3" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Locker rooms and shower facilities</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Variety and quality of equipment" id="factor_4" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_4" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Variety and quality of equipment</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Availability of seating area" id="factor_5" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_5" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Availability of seating area</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Cleanliness and maintenance" id="factor_6" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_6" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Cleanliness and maintenance</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Commuting convenience" id="factor_7" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_7" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Commuting convenience</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="ranked_factors" value="Other" id="factor_8" class="factor-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="factor_8" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Other: 
                            <input type="text" name="ranked_factors_other" id="factor_other" placeholder="Please specify" style="display: none; font-size: 16px; padding: 8px; width: 200px; margin-left: 10px; border: 1px solid #ccc;">
                        </label>
                    </td>
                </tr>
            </table>
            <p id="factor_limit_msg" style="color: red; font-size: 14px; display: none;">Maximum 3 selections allowed</p>
            <div class="error" id="error_ranked_factors">Please select exactly 3 factors</div>
        </div>

        <!-- Section 2: Comfort Zone Concept -->
        <div class="section">
            <h2>Section 2: Comfort Zone Concept</h2>
            <p style="font-size: 16px; color: #666; margin-bottom: 15px;">
                We're Refreshing the Fitness Center<br>
                We're exploring adding a dedicated comfort zone—a place to restore and recharge between workouts. 
                This space would provide a comfortable environment to relax, transition between activities, and prepare mentally for your next set.
            </p>

            <div id="image_container" style="text-align: center; margin: 20px 0;">
                <img id="rendering_image" src="" alt="Comfort Zone Rendering" style="max-width: 100%; height: auto; border: 1px solid #ccc;">
                <p style="font-size: 14px; color: #666; margin-top: 10px;">View How It Looks in Space →</p>
                <p style="font-size: 12px; color: #999; margin-top: 5px;">Renderings are conceptual — shown for inspiration, not final design.</p>
            </div>

            <!-- Question 3: Comfort Zone Amenities -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        Please select your top 3 elements that would be most valuable in this comfort zone <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Comfortable seating (e.g., couches and lounge chairs)" id="amenity_1" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_1" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Comfortable seating (e.g., couches and lounge chairs)</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Vending machine" id="amenity_2" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_2" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Vending machine</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Information / achievement board" id="amenity_3" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_3" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Information / achievement board</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Interaction & networking opportunities" id="amenity_4" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_4" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Interaction & networking opportunities</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Books / magazines" id="amenity_5" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_5" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Books / magazines</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Charging ports" id="amenity_6" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_6" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Charging ports</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Plants and natural elements" id="amenity_7" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_7" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Plants and natural elements</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Places to hang coats and change shoes" id="amenity_8" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_8" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Places to hang coats and change shoes</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="checkbox" name="comfort_zone_amenities" value="Other" id="amenity_9" class="amenity-checkbox" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="amenity_9" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Other: 
                            <input type="text" name="comfort_zone_other" id="amenity_other" placeholder="Please specify" style="display: none; font-size: 16px; padding: 8px; width: 200px; margin-left: 10px; border: 1px solid #ccc;">
                        </label>
                    </td>
                </tr>
            </table>
            <p id="amenity_limit_msg" style="color: red; font-size: 14px; display: none;">Maximum 3 selections allowed</p>
            <div class="error" id="error_comfort_zone_amenities">Please select exactly 3 elements</div>

            <!-- Question 4: Usage Frequency -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        If this comfort zone were available and you were satisfied with it, how often would you use this space? <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="usage_frequency" value="Rarely (once a month or less)" id="usage_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="usage_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Rarely (once a month or less)</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="usage_frequency" value="Sometimes (2-3 times per month)" id="usage_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="usage_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Sometimes (2-3 times per month)</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="usage_frequency" value="Often (1-2 times per week)" id="usage_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="usage_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Often (1-2 times per week)</label>
                    </td>
                </tr>
            </table>
            <div class="error" id="error_usage_frequency">Please select an option</div>

            <!-- Question 5: Membership Type -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        Your Membership Type: <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="membership_type" value="I'm not a member yet" id="member_1" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="member_1" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">I'm not a member yet</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="membership_type" value="Pay-per-use / Day rate" id="member_2" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="member_2" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Pay-per-use / Day rate</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="membership_type" value="Monthly" id="member_3" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="member_3" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Monthly</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="membership_type" value="6 Month" id="member_4" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="member_4" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">6 Month</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="membership_type" value="Annual" id="member_5" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="member_5" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Annual</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px; text-align: center;">
                        <input type="radio" name="membership_type" value="Other" id="member_6" style="width: 28px; height: 28px; cursor: pointer;">
                    </td>
                    <td>
                        <label for="member_6" style="font-size: 18px; cursor: pointer; display: block; padding: 10px;">Other (Please specify): 
                            <input type="text" name="membership_type_other" id="member_other" placeholder="Please specify" style="display: none; font-size: 16px; padding: 8px; width: 200px; margin-left: 10px; border: 1px solid #ccc;">
                        </label>
                    </td>
                </tr>
            </table>
            <div class="error" id="error_membership_type">Please select an option</div>

            <!-- Question 6: Membership Duration (Conditional) -->
            <div id="membership_duration_section" style="display: none;">
                <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                    <tr>
                        <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                            (If you are a member) For how long have you been a member? <span style="color: red;">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_duration" value="Less than 6 months" id="duration_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="duration_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Less than 6 months</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_duration" value="6 Months to 1 Year" id="duration_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="duration_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">6 Months to 1 Year</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_duration" value="1-3 Years" id="duration_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="duration_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1-3 Years</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_duration" value="3-5 Years" id="duration_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="duration_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3-5 Years</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_duration" value="5+ Years" id="duration_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="duration_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5+ Years</label>
                        </td>
                    </tr>
                </table>
                <div class="error" id="error_membership_duration">Please select an option</div>
            </div>

            <!-- Question 7: Membership Impact Renewal (Conditional) -->
            <div id="membership_impact_renewal_section" style="display: none;">
                <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                    <tr>
                        <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                            How would adding this comfort zone affect your likelihood to <strong>renew</strong> your membership? <span style="color: red;">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_renewal" value="Much less likely to renew" id="renewal_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="renewal_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Much less likely to renew</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_renewal" value="Somewhat less likely to renew" id="renewal_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="renewal_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Somewhat less likely to renew</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_renewal" value="No impact on my decision" id="renewal_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="renewal_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">No impact on my decision</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_renewal" value="Somewhat more likely to renew" id="renewal_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="renewal_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Somewhat more likely to renew</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_renewal" value="Much more likely to renew" id="renewal_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="renewal_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Much more likely to renew</label>
                        </td>
                    </tr>
                </table>
                <div class="error" id="error_membership_impact_renewal">Please select an option</div>
            </div>

            <!-- Question 8: Membership Impact Join (Conditional) -->
            <div id="membership_impact_join_section" style="display: none;">
                <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                    <tr>
                        <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                            How would this comfort zone affect your likelihood to <strong>join</strong> with a new membership? <span style="color: red;">*</span>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_join" value="Much less likely to join" id="join_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="join_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Much less likely to join</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_join" value="Somewhat less likely to join" id="join_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="join_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Somewhat less likely to join</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_join" value="No impact on my decision" id="join_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="join_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">No impact on my decision</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_join" value="Somewhat more likely to join" id="join_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="join_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Somewhat more likely to join</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                            <input type="radio" name="membership_impact_join" value="Much more likely to join" id="join_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        </td>
                        <td style="display: table-cell !important; visibility: visible !important;">
                            <label for="join_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Much more likely to join</label>
                        </td>
                    </tr>
                </table>
                <div class="error" id="error_membership_impact_join">Please select an option</div>
            </div>
        </div>

        <!-- Section 3: Wellness & Balance Assessment -->
        <div class="section">
            <h2>Section 3: Wellness & Balance Assessment</h2>
            <p style="font-size: 16px; color: #666; margin-bottom: 15px;">
                Think about how each statement fits you<br>
                Please check the option that feels most true right now.
            </p>

            <!-- Wellness Question 1 -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="6" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        I have balanced exercise, nutrition, and rest patterns <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Disagree</td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q1" value="1" id="wellness1_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness1_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q1" value="2" id="wellness1_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness1_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">2</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q1" value="3" id="wellness1_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness1_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q1" value="4" id="wellness1_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness1_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">4</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q1" value="5" id="wellness1_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness1_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="6" style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Agree</td>
                </tr>
            </table>
            <div class="error" id="error_wellness_q1">Please select an option</div>

            <!-- Wellness Question 2 -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="6" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        I maintain regular practices that help me stay centered and connected <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Disagree</td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q2" value="1" id="wellness2_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness2_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q2" value="2" id="wellness2_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness2_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">2</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q2" value="3" id="wellness2_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness2_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q2" value="4" id="wellness2_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness2_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">4</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q2" value="5" id="wellness2_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness2_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="6" style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Agree</td>
                </tr>
            </table>
            <div class="error" id="error_wellness_q2">Please select an option</div>

            <!-- Wellness Question 3 -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="6" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        I actively engage in learning to keep my mind focused and alert <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Disagree</td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q3" value="1" id="wellness3_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness3_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q3" value="2" id="wellness3_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness3_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">2</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q3" value="3" id="wellness3_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness3_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q3" value="4" id="wellness3_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness3_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">4</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q3" value="5" id="wellness3_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness3_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="6" style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Agree</td>
                </tr>
            </table>
            <div class="error" id="error_wellness_q3">Please select an option</div>

            <!-- Wellness Question 4 -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="6" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        I have consistent, genuine connections with others that make me feel supported <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Disagree</td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q4" value="1" id="wellness4_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness4_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q4" value="2" id="wellness4_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness4_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">2</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q4" value="3" id="wellness4_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness4_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q4" value="4" id="wellness4_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness4_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">4</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q4" value="5" id="wellness4_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness4_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="6" style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Agree</td>
                </tr>
            </table>
            <div class="error" id="error_wellness_q4">Please select an option</div>

            <!-- Wellness Question 5 -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="6" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        I am aware of my feelings and reflect on my emotions as part of staying balanced <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Disagree</td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q5" value="1" id="wellness5_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness5_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q5" value="2" id="wellness5_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness5_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">2</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q5" value="3" id="wellness5_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness5_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q5" value="4" id="wellness5_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness5_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">4</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q5" value="5" id="wellness5_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness5_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="6" style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Agree</td>
                </tr>
            </table>
            <div class="error" id="error_wellness_q5">Please select an option</div>

            <!-- Wellness Question 6 -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="6" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        My current work environment aligns with my skills and values <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Disagree</td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q6" value="1" id="wellness6_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness6_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">1</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q6" value="2" id="wellness6_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness6_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">2</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q6" value="3" id="wellness6_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness6_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">3</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q6" value="4" id="wellness6_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness6_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">4</label>
                    </td>
                    <td style="text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="wellness_q6" value="5" id="wellness6_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                        <label for="wellness6_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">5</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="6" style="text-align: center !important; font-size: 14px !important; color: #666 !important; display: table-cell !important; visibility: visible !important;">Agree</td>
                </tr>
            </table>
            <div class="error" id="error_wellness_q6">Please select an option</div>
        </div>

        <!-- Section 4: Demographics -->
        <div class="section">
            <h2>Section 4: Demographics</h2>

            <!-- Question: Age Group -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        Age Group <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="18-24" id="age_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">18-24</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="25-34" id="age_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">25-34</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="35-45" id="age_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">35-45</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="45-54" id="age_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">45-54</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="55-64" id="age_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">55-64</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="65-74" id="age_6" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_6" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">65-74</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="age_group" value="75+" id="age_7" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="age_7" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">75+</label>
                    </td>
                </tr>
            </table>
            <div class="error" id="error_age_group">Please select an option</div>

            <!-- Question: Gender -->
            <table border="1" cellpadding="10" cellspacing="0" style="width: 100% !important; margin-bottom: 20px !important; background-color: #ffffff !important; display: table !important; visibility: visible !important; opacity: 1 !important; border-collapse: collapse !important;">
                <tr>
                    <td colspan="2" style="background-color: #f0f0f0 !important; font-weight: bold !important; font-size: 16px !important; display: table-cell !important; visibility: visible !important;">
                        Gender <span style="color: red;">*</span>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="gender" value="M" id="gender_1" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="gender_1" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">M</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="gender" value="F" id="gender_2" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="gender_2" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">F</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="gender" value="Transgender" id="gender_3" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="gender_3" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Transgender</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="gender" value="Prefer not to respond" id="gender_4" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="gender_4" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Prefer not to respond</label>
                    </td>
                </tr>
                <tr>
                    <td style="width: 50px !important; text-align: center !important; display: table-cell !important; visibility: visible !important;">
                        <input type="radio" name="gender" value="Prefer to self-describe" id="gender_5" style="width: 28px !important; height: 28px !important; cursor: pointer !important; display: inline-block !important; visibility: visible !important; opacity: 1 !important;">
                    </td>
                    <td style="display: table-cell !important; visibility: visible !important;">
                        <label for="gender_5" style="font-size: 18px !important; cursor: pointer !important; display: block !important; padding: 10px !important; visibility: visible !important; opacity: 1 !important; color: #000000 !important;">Prefer to self-describe: 
                            <input type="text" name="gender_other" id="gender_other" placeholder="Please specify" style="display: none; font-size: 16px; padding: 8px; width: 200px; margin-left: 10px; border: 1px solid #ccc;">
                        </label>
                    </td>
                </tr>
            </table>
            <div class="error" id="error_gender">Please select an option</div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="submit-btn" id="submitBtn">Submit Survey</button>
        <div class="success" id="successMessage"></div>
        
        <!-- CSV Export Button (for admin/testing) -->
        <button type="button" class="submit-btn" id="exportBtn" style="display: none; background-color: #FF6B6B; margin-top: 10px;" onclick="exportToCSV()">Export Responses to CSV</button>
    </form>

    <script>
        // ES5 JavaScript Only - No arrow functions, no const/let
        
        // Global variables
        var imageVersion = '';
        var allResponses = [];
        
        // Google Sheets configuration
        // Google Apps Script Web App URL - configured for your Google Sheets
        var GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyJoQ3FQE-XzU3X-Lp3-XEBuyfj6E5GljvP_j3-geymMcxzTfTKIuLOQ-daGrQ_ub9rlw/exec';
        
        // Enable/disable Google Sheets submission
        var ENABLE_GOOGLE_SHEETS = GOOGLE_APPS_SCRIPT_URL && GOOGLE_APPS_SCRIPT_URL.length > 0;
        
        // Debug mode for Google Sheets submission
        var DEBUG_GOOGLE_SHEETS = true;
        
        // Initialize on page load
        window.addEventListener('load', function() {
            selectRandomImage();
            setupCheckboxLimits();
            setupConditionalQuestions();
            setupOtherInputs();
            
            // Show export button if admin parameter in URL
            var urlParams = window.location.search.substring(1).split('&');
            for (var i = 0; i < urlParams.length; i++) {
                var param = urlParams[i].split('=');
                if (param[0] === 'admin' && param[1] === '1') {
                    document.getElementById('exportBtn').style.display = 'block';
                }
            }
        });
        
        // Select random image
        function selectRandomImage() {
            var random = Math.random();
            // Use relative path - works both locally and on GitHub Pages
            // Images are in the root images/ folder
            var imagePath = random < 0.5 ? 'images/comfort-zone-v1.jpg' : 'images/comfort-zone-v2.jpg';
            imageVersion = random < 0.5 ? 'v1' : 'v2';
            var imgElement = document.getElementById('rendering_image');
            if (imgElement) {
                imgElement.src = imagePath;
                // Add error handler to debug image loading
                imgElement.onerror = function() {
                    console.error('Image failed to load: ' + imagePath);
                    console.error('Current pathname: ' + window.location.pathname);
                    console.error('Current href: ' + window.location.href);
                    // Try alternative paths
                    var altPath1 = './images/' + (random < 0.5 ? 'comfort-zone-v1.jpg' : 'comfort-zone-v2.jpg');
                    var altPath2 = '/images/' + (random < 0.5 ? 'comfort-zone-v1.jpg' : 'comfort-zone-v2.jpg');
                    console.log('Trying alternative path 1: ' + altPath1);
                    this.src = altPath1;
                    this.onerror = function() {
                        console.log('Trying alternative path 2: ' + altPath2);
                        this.src = altPath2;
                    };
                };
                imgElement.onload = function() {
                    console.log('Image loaded successfully: ' + imagePath);
                };
            }
        }
        
        // Setup checkbox limits (max 3 selections)
        function setupCheckboxLimits() {
            var factorCheckboxes = document.querySelectorAll('.factor-checkbox');
            for (var i = 0; i < factorCheckboxes.length; i++) {
                factorCheckboxes[i].addEventListener('change', function() {
                    enforceCheckboxLimit('ranked_factors', 'factor_limit_msg', 'error_ranked_factors');
                });
            }
            
            var amenityCheckboxes = document.querySelectorAll('.amenity-checkbox');
            for (var j = 0; j < amenityCheckboxes.length; j++) {
                amenityCheckboxes[j].addEventListener('change', function() {
                    enforceCheckboxLimit('comfort_zone_amenities', 'amenity_limit_msg', 'error_comfort_zone_amenities');
                });
            }
        }
        
        // Enforce checkbox limit
        function enforceCheckboxLimit(name, msgId, errorId) {
            var checkboxes = document.querySelectorAll('input[name="' + name + '"]');
            var checked = [];
            for (var i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].checked) {
                    checked.push(checkboxes[i]);
                }
            }
            
            if (checked.length > 3) {
                // Uncheck the last one
                checked[checked.length - 1].checked = false;
                document.getElementById(msgId).style.display = 'block';
                setTimeout(function() {
                    document.getElementById(msgId).style.display = 'none';
                }, 3000);
            }
        }
        
        // Setup conditional questions
        function setupConditionalQuestions() {
            var membershipTypeRadios = document.querySelectorAll('input[name="membership_type"]');
            for (var i = 0; i < membershipTypeRadios.length; i++) {
                membershipTypeRadios[i].addEventListener('change', function() {
                    showHideConditional();
                });
            }
            showHideConditional();
        }
        
        // Show/hide conditional questions based on membership type
        function showHideConditional() {
            var membershipType = document.querySelector('input[name="membership_type"]:checked');
            var durationSection = document.getElementById('membership_duration_section');
            var renewalSection = document.getElementById('membership_impact_renewal_section');
            var joinSection = document.getElementById('membership_impact_join_section');
            
            if (membershipType && membershipType.value !== "I'm not a member yet") {
                durationSection.style.display = 'block';
                renewalSection.style.display = 'block';
                joinSection.style.display = 'none';
            } else {
                durationSection.style.display = 'none';
                renewalSection.style.display = 'none';
                joinSection.style.display = 'block';
            }
        }
        
        // Setup "Other" text inputs
        function setupOtherInputs() {
            // Factor other
            var factorOther = document.getElementById('factor_8');
            var factorOtherInput = document.getElementById('factor_other');
            if (factorOther) {
                factorOther.addEventListener('change', function() {
                    factorOtherInput.style.display = this.checked ? 'inline-block' : 'none';
                });
            }
            
            // Amenity other
            var amenityOther = document.getElementById('amenity_9');
            var amenityOtherInput = document.getElementById('amenity_other');
            if (amenityOther) {
                amenityOther.addEventListener('change', function() {
                    amenityOtherInput.style.display = this.checked ? 'inline-block' : 'none';
                });
            }
            
            // Membership type other
            var memberOther = document.getElementById('member_6');
            var memberOtherInput = document.getElementById('member_other');
            if (memberOther) {
                memberOther.addEventListener('change', function() {
                    memberOtherInput.style.display = this.checked ? 'inline-block' : 'none';
                });
            }
            
            // Gender other
            var genderOther = document.getElementById('gender_5');
            var genderOtherInput = document.getElementById('gender_other');
            if (genderOther) {
                genderOther.addEventListener('change', function() {
                    genderOtherInput.style.display = this.checked ? 'inline-block' : 'none';
                });
            }
        }
        
        // Form validation
        function validateForm() {
            var isValid = true;
            var errors = [];
            
            // Clear all errors
            var errorDivs = document.querySelectorAll('.error');
            for (var e = 0; e < errorDivs.length; e++) {
                errorDivs[e].classList.remove('show');
            }
            
            // Validate overall satisfaction
            if (!document.querySelector('input[name="overall_satisfaction"]:checked')) {
                document.getElementById('error_overall_satisfaction').classList.add('show');
                isValid = false;
            }
            
            // Validate ranked factors (exactly 3)
            var factorCheckboxes = document.querySelectorAll('input[name="ranked_factors"]:checked');
            if (factorCheckboxes.length !== 3) {
                document.getElementById('error_ranked_factors').classList.add('show');
                isValid = false;
            }
            
            // Validate comfort zone amenities (exactly 3)
            var amenityCheckboxes = document.querySelectorAll('input[name="comfort_zone_amenities"]:checked');
            if (amenityCheckboxes.length !== 3) {
                document.getElementById('error_comfort_zone_amenities').classList.add('show');
                isValid = false;
            }
            
            // Validate usage frequency
            if (!document.querySelector('input[name="usage_frequency"]:checked')) {
                document.getElementById('error_usage_frequency').classList.add('show');
                isValid = false;
            }
            
            // Validate membership type
            if (!document.querySelector('input[name="membership_type"]:checked')) {
                document.getElementById('error_membership_type').classList.add('show');
                isValid = false;
            }
            
            // Validate membership duration (if shown)
            var durationSection = document.getElementById('membership_duration_section');
            if (durationSection.style.display !== 'none') {
                if (!document.querySelector('input[name="membership_duration"]:checked')) {
                    document.getElementById('error_membership_duration').classList.add('show');
                    isValid = false;
                }
            }
            
            // Validate membership impact renewal (if shown)
            var renewalSection = document.getElementById('membership_impact_renewal_section');
            if (renewalSection.style.display !== 'none') {
                if (!document.querySelector('input[name="membership_impact_renewal"]:checked')) {
                    document.getElementById('error_membership_impact_renewal').classList.add('show');
                    isValid = false;
                }
            }
            
            // Validate membership impact join (if shown)
            var joinSection = document.getElementById('membership_impact_join_section');
            if (joinSection.style.display !== 'none') {
                if (!document.querySelector('input[name="membership_impact_join"]:checked')) {
                    document.getElementById('error_membership_impact_join').classList.add('show');
                    isValid = false;
                }
            }
            
            // Validate wellness questions
            for (var w = 1; w <= 6; w++) {
                if (!document.querySelector('input[name="wellness_q' + w + '"]:checked')) {
                    document.getElementById('error_wellness_q' + w).classList.add('show');
                    isValid = false;
                }
            }
            
            // Validate age group
            if (!document.querySelector('input[name="age_group"]:checked')) {
                document.getElementById('error_age_group').classList.add('show');
                isValid = false;
            }
            
            // Validate gender
            if (!document.querySelector('input[name="gender"]:checked')) {
                document.getElementById('error_gender').classList.add('show');
                isValid = false;
            }
            
            return isValid;
        }
        
        // Collect form data
        function collectFormData() {
            var data = {};
            
            // Overall satisfaction
            var overallSatisfaction = document.querySelector('input[name="overall_satisfaction"]:checked');
            data.overall_satisfaction = overallSatisfaction ? overallSatisfaction.value : '';
            
            // Ranked factors (top 3)
            var factorCheckboxes = document.querySelectorAll('input[name="ranked_factors"]:checked');
            data.ranked_factor_1 = factorCheckboxes[0] ? factorCheckboxes[0].value : '';
            data.ranked_factor_2 = factorCheckboxes[1] ? factorCheckboxes[1].value : '';
            data.ranked_factor_3 = factorCheckboxes[2] ? factorCheckboxes[2].value : '';
            var factorOtherInput = document.getElementById('factor_other');
            data.ranked_factors_other = factorOtherInput && factorOtherInput.value ? factorOtherInput.value : '';
            
            // Image version
            data.image_version_shown = imageVersion;
            
            // Comfort zone amenities (top 3)
            var amenityCheckboxes = document.querySelectorAll('input[name="comfort_zone_amenities"]:checked');
            data.comfort_zone_amenity_1 = amenityCheckboxes[0] ? amenityCheckboxes[0].value : '';
            data.comfort_zone_amenity_2 = amenityCheckboxes[1] ? amenityCheckboxes[1].value : '';
            data.comfort_zone_amenity_3 = amenityCheckboxes[2] ? amenityCheckboxes[2].value : '';
            var amenityOtherInput = document.getElementById('amenity_other');
            data.comfort_zone_other = amenityOtherInput && amenityOtherInput.value ? amenityOtherInput.value : '';
            
            // Usage frequency
            var usageFrequency = document.querySelector('input[name="usage_frequency"]:checked');
            data.usage_frequency = usageFrequency ? usageFrequency.value : '';
            
            // Membership type
            var membershipType = document.querySelector('input[name="membership_type"]:checked');
            data.membership_type = membershipType ? membershipType.value : '';
            var memberOtherInput = document.getElementById('member_other');
            data.membership_type_other = memberOtherInput && memberOtherInput.value ? memberOtherInput.value : '';
            
            // Membership duration
            var membershipDuration = document.querySelector('input[name="membership_duration"]:checked');
            data.membership_duration = membershipDuration ? membershipDuration.value : '';
            
            // Membership impact renewal
            var membershipImpactRenewal = document.querySelector('input[name="membership_impact_renewal"]:checked');
            data.membership_impact_renewal = membershipImpactRenewal ? membershipImpactRenewal.value : '';
            
            // Membership impact join
            var membershipImpactJoin = document.querySelector('input[name="membership_impact_join"]:checked');
            data.membership_impact_join = membershipImpactJoin ? membershipImpactJoin.value : '';
            
            // Wellness questions
            for (var w = 1; w <= 6; w++) {
                var wellnessQ = document.querySelector('input[name="wellness_q' + w + '"]:checked');
                data['wellness_q' + w] = wellnessQ ? wellnessQ.value : '';
            }
            
            // Age group
            var ageGroup = document.querySelector('input[name="age_group"]:checked');
            data.age_group = ageGroup ? ageGroup.value : '';
            
            // Gender
            var gender = document.querySelector('input[name="gender"]:checked');
            data.gender = gender ? gender.value : '';
            var genderOtherInput = document.getElementById('gender_other');
            data.gender_self_describe = genderOtherInput && genderOtherInput.value ? genderOtherInput.value : '';
            
            return data;
        }
        
        // Note: The data format matches Google Apps Script expectations
        // Field names: overall_satisfaction, ranked_factor_1-3, ranked_factors_other,
        // image_version_shown, comfort_zone_amenity_1-3, comfort_zone_other,
        // usage_frequency, membership_type, membership_type_other, membership_duration,
        // membership_impact_renewal, membership_impact_join, wellness_q1-6,
        // age_group, gender, gender_self_describe
        
        // Escape CSV field
        function escapeCSVField(field) {
            if (field === null || field === undefined || field === '') {
                return '';
            }
            var stringField = String(field);
            if (stringField.indexOf(',') !== -1 || stringField.indexOf('"') !== -1 || stringField.indexOf('\n') !== -1) {
                return '"' + stringField.replace(/"/g, '""') + '"';
            }
            return stringField;
        }
        
        // Convert to CSV row
        function convertToCSVRow(data, timestamp) {
            var csvColumns = [
                'Timestamp',
                'Overall_Satisfaction',
                'Ranked_Factor_1',
                'Ranked_Factor_2',
                'Ranked_Factor_3',
                'Ranked_Factors_Other',
                'Image_Version_Shown',
                'Comfort_Zone_Amenity_1',
                'Comfort_Zone_Amenity_2',
                'Comfort_Zone_Amenity_3',
                'Comfort_Zone_Other',
                'Usage_Frequency',
                'Membership_Type',
                'Membership_Type_Other',
                'Membership_Duration',
                'Membership_Impact_Renewal',
                'Membership_Impact_Join',
                'Wellness_Q1',
                'Wellness_Q2',
                'Wellness_Q3',
                'Wellness_Q4',
                'Wellness_Q5',
                'Wellness_Q6',
                'Age_Group',
                'Gender',
                'Gender_Self_Describe'
            ];
            
            var row = [];
            for (var i = 0; i < csvColumns.length; i++) {
                var column = csvColumns[i];
                var value = '';
                
                switch (column) {
                    case 'Timestamp':
                        value = timestamp || new Date().toISOString().replace('T', ' ').substring(0, 19);
                        break;
                    case 'Overall_Satisfaction':
                        value = data.overall_satisfaction || '';
                        break;
                    case 'Ranked_Factor_1':
                        value = data.ranked_factor_1 || '';
                        break;
                    case 'Ranked_Factor_2':
                        value = data.ranked_factor_2 || '';
                        break;
                    case 'Ranked_Factor_3':
                        value = data.ranked_factor_3 || '';
                        break;
                    case 'Ranked_Factors_Other':
                        value = data.ranked_factors_other || '';
                        break;
                    case 'Image_Version_Shown':
                        value = data.image_version_shown || '';
                        break;
                    case 'Comfort_Zone_Amenity_1':
                        value = data.comfort_zone_amenity_1 || '';
                        break;
                    case 'Comfort_Zone_Amenity_2':
                        value = data.comfort_zone_amenity_2 || '';
                        break;
                    case 'Comfort_Zone_Amenity_3':
                        value = data.comfort_zone_amenity_3 || '';
                        break;
                    case 'Comfort_Zone_Other':
                        value = data.comfort_zone_other || '';
                        break;
                    case 'Usage_Frequency':
                        value = data.usage_frequency || '';
                        break;
                    case 'Membership_Type':
                        value = data.membership_type || '';
                        break;
                    case 'Membership_Type_Other':
                        value = data.membership_type_other || '';
                        break;
                    case 'Membership_Duration':
                        value = data.membership_duration || '';
                        break;
                    case 'Membership_Impact_Renewal':
                        value = data.membership_impact_renewal || '';
                        break;
                    case 'Membership_Impact_Join':
                        value = data.membership_impact_join || '';
                        break;
                    case 'Wellness_Q1':
                        value = data.wellness_q1 || '';
                        break;
                    case 'Wellness_Q2':
                        value = data.wellness_q2 || '';
                        break;
                    case 'Wellness_Q3':
                        value = data.wellness_q3 || '';
                        break;
                    case 'Wellness_Q4':
                        value = data.wellness_q4 || '';
                        break;
                    case 'Wellness_Q5':
                        value = data.wellness_q5 || '';
                        break;
                    case 'Wellness_Q6':
                        value = data.wellness_q6 || '';
                        break;
                    case 'Age_Group':
                        value = data.age_group || '';
                        break;
                    case 'Gender':
                        value = data.gender || '';
                        break;
                    case 'Gender_Self_Describe':
                        value = data.gender_self_describe || '';
                        break;
                    default:
                        value = '';
                }
                
                row.push(escapeCSVField(value));
            }
            
            return row.join(',');
        }
        
        // Save to localStorage
        function saveToLocalStorage(data, timestamp) {
            try {
                var storageKey = 'survey_responses';
                var stored = localStorage.getItem(storageKey);
                var allResponses = stored ? JSON.parse(stored) : [];
                
                allResponses.push({
                    timestamp: timestamp,
                    data: data
                });
                
                localStorage.setItem(storageKey, JSON.stringify(allResponses));
                return allResponses;
            } catch (e) {
                console.error('Error saving to localStorage:', e);
                return [];
            }
        }
        
        // Export to CSV
        function exportToCSV() {
            try {
                var storageKey = 'survey_responses';
                var stored = localStorage.getItem(storageKey);
                var allResponses = stored ? JSON.parse(stored) : [];
                
                if (allResponses.length === 0) {
                    alert('No responses to export');
                    return;
                }
                
                var csvColumns = [
                    'Timestamp',
                    'Overall_Satisfaction',
                    'Ranked_Factor_1',
                    'Ranked_Factor_2',
                    'Ranked_Factor_3',
                    'Ranked_Factors_Other',
                    'Image_Version_Shown',
                    'Comfort_Zone_Amenity_1',
                    'Comfort_Zone_Amenity_2',
                    'Comfort_Zone_Amenity_3',
                    'Comfort_Zone_Other',
                    'Usage_Frequency',
                    'Membership_Type',
                    'Membership_Type_Other',
                    'Membership_Duration',
                    'Membership_Impact_Renewal',
                    'Membership_Impact_Join',
                    'Wellness_Q1',
                    'Wellness_Q2',
                    'Wellness_Q3',
                    'Wellness_Q4',
                    'Wellness_Q5',
                    'Wellness_Q6',
                    'Age_Group',
                    'Gender',
                    'Gender_Self_Describe'
                ];
                
                var csvContent = csvColumns.join(',') + '\n';
                
                for (var i = 0; i < allResponses.length; i++) {
                    var csvRow = convertToCSVRow(allResponses[i].data, allResponses[i].timestamp);
                    csvContent += csvRow + '\n';
                }
                
                // Create download link
                var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                var link = document.createElement('a');
                var url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'survey_responses_' + new Date().getTime() + '.csv');
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (e) {
                alert('Error exporting CSV: ' + e.message);
            }
        }
        
        // Submit to Google Sheets using form submission (avoids CORS preflight)
        // This method doesn't trigger OPTIONS preflight request, avoiding 405 errors
        function submitToGoogleSheets(data) {
            return new Promise(function(resolve, reject) {
                if (!ENABLE_GOOGLE_SHEETS || !GOOGLE_APPS_SCRIPT_URL) {
                    reject(new Error('Google Sheets integration is not configured'));
                    return;
                }
                
                // Validate URL format
                if (GOOGLE_APPS_SCRIPT_URL.indexOf('https://script.google.com/') !== 0) {
                    reject(new Error('Invalid Google Apps Script URL format'));
                    return;
                }
                
                // Debug: Log submission attempt
                if (DEBUG_GOOGLE_SHEETS) {
                    console.log('📤 Submitting to Google Sheets:', {
                        url: GOOGLE_APPS_SCRIPT_URL,
                        data: data,
                        timestamp: new Date().toISOString()
                    });
                }
                
                // Use form submission method to avoid CORS preflight (OPTIONS) request
                // This works better with Google Apps Script Web Apps
                try {
                    // Create a hidden form
                    var form = document.createElement('form');
                    form.method = 'POST';
                    form.action = GOOGLE_APPS_SCRIPT_URL;
                    form.style.display = 'none';
                    
                    // Create a hidden iframe to submit to (avoids page navigation)
                    var iframe = document.createElement('iframe');
                    iframe.name = 'googleSheetsSubmitFrame';
                    iframe.style.display = 'none';
                    document.body.appendChild(iframe);
                    
                    form.target = 'googleSheetsSubmitFrame';
                    
                    // Add all data as hidden inputs
                    for (var key in data) {
                        if (data.hasOwnProperty(key)) {
                            var input = document.createElement('input');
                            input.type = 'hidden';
                            input.name = key;
                            // Convert value to string, handle objects/arrays
                            var value = data[key];
                            if (typeof value === 'object' && value !== null) {
                                value = JSON.stringify(value);
                            } else {
                                value = String(value || '');
                            }
                            input.value = value;
                            form.appendChild(input);
                        }
                    }
                    
                    // Also send as JSON in a special field for Code.gs to parse
                    var jsonInput = document.createElement('input');
                    jsonInput.type = 'hidden';
                    jsonInput.name = 'jsonData';
                    jsonInput.value = JSON.stringify(data);
                    form.appendChild(jsonInput);
                    
                    document.body.appendChild(form);
                    
                    // Handle iframe load (success)
                    iframe.onload = function() {
                        if (DEBUG_GOOGLE_SHEETS) {
                            console.log('✅ Form submitted successfully');
                        }
                        
                        // Clean up
                        setTimeout(function() {
                            document.body.removeChild(form);
                            document.body.removeChild(iframe);
                        }, 1000);
                        
                        resolve({
                            success: true,
                            message: 'Data submitted successfully to Google Sheets'
                        });
                    };
                    
                    // Submit the form
                    form.submit();
                    
                    // Fallback: assume success after a short delay (form submission is fire-and-forget)
                    setTimeout(function() {
                        // Check if iframe was removed (means onload fired)
                        if (iframe.parentNode) {
                            // If still here, assume success anyway (form submission is async)
                            if (DEBUG_GOOGLE_SHEETS) {
                                console.log('✅ Form submitted (assuming success)');
                            }
                            
                            // Clean up
                            if (form.parentNode) {
                                document.body.removeChild(form);
                            }
                            if (iframe.parentNode) {
                                document.body.removeChild(iframe);
                            }
                            
                            resolve({
                                success: true,
                                message: 'Data submitted successfully to Google Sheets'
                            });
                        }
                    }, 2000);
                    
                } catch (e) {
                    if (DEBUG_GOOGLE_SHEETS) {
                        console.error('❌ Failed to submit form:', e);
                    }
                    reject(new Error('Failed to submit: ' + e.message));
                }
            });
        }
        
        // Form submit handler
        document.getElementById('surveyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateForm()) {
                alert('Please fill in all required fields correctly.');
                return;
            }
            
            var submitBtn = document.getElementById('submitBtn');
            var originalText = submitBtn.textContent;
            
            // Set loading state
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            var data = collectFormData();
            var timestamp = new Date().toISOString().replace('T', ' ').substring(0, 19);
            
            // Prepare data for submission (combine timestamp with data)
            var submitData = {};
            submitData.timestamp = timestamp;
            for (var key in data) {
                if (data.hasOwnProperty(key)) {
                    submitData[key] = data[key];
                }
            }
            
            var googleSheetsSuccess = false;
            var localStorageSuccess = false;
            var googleSheetsError = null;
            
            // Try to submit to Google Sheets first
            if (ENABLE_GOOGLE_SHEETS) {
                if (DEBUG_GOOGLE_SHEETS) {
                    console.log('📋 Form data prepared for submission:', submitData);
                }
                
                submitToGoogleSheets(submitData).then(function(result) {
                    googleSheetsSuccess = result && result.success === true;
                    
                    if (DEBUG_GOOGLE_SHEETS) {
                        if (googleSheetsSuccess) {
                            console.log('✅ Google Sheets submission successful');
                        } else {
                            console.warn('⚠️ Google Sheets submission returned unsuccessful result');
                        }
                    }
                    
                    // Save to localStorage as backup
                    try {
                        localStorageSuccess = saveToLocalStorage(data, timestamp);
                    } catch (error) {
                        console.error('localStorage save failed:', error);
                    }
                    
                    // Show success message with better visibility
                    var successMsg = document.getElementById('successMessage');
                    if (googleSheetsSuccess) {
                        successMsg.innerHTML = '✅ <strong>提交成功！</strong> 您的回复已成功提交到 Google Sheets。感谢您的参与！';
                        successMsg.style.backgroundColor = '#d4edda';
                        successMsg.style.color = '#155724';
                        successMsg.style.borderColor = '#c3e6cb';
                        if (DEBUG_GOOGLE_SHEETS) {
                            console.log('✅ Success message displayed to user');
                        }
                    } else {
                        successMsg.innerHTML = '⚠️ 您的回复已保存到本地存储。Google Sheets 提交失败。';
                        successMsg.style.backgroundColor = '#fff3cd';
                        successMsg.style.color = '#856404';
                        successMsg.style.borderColor = '#ffeaa7';
                    }
                    successMsg.classList.add('show');
                    
                    // Scroll to top smoothly
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                    
                    // Reset form after 5 seconds (give user time to see success message)
                    setTimeout(function() {
                        document.getElementById('surveyForm').reset();
                        successMsg.classList.remove('show');
                        successMsg.innerHTML = '';
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        selectRandomImage();
                        showHideConditional();
                    }, 5000);
                }).catch(function(error) {
                    googleSheetsError = error;
                    console.error('Google Sheets submission error:', error);
                    
                    // Save to localStorage as backup
                    try {
                        localStorageSuccess = saveToLocalStorage(data, timestamp);
                    } catch (localError) {
                        console.error('localStorage save failed:', localError);
                    }
                    
                    // Show message (success for localStorage, warning about Google Sheets)
                    var successMsg = document.getElementById('successMessage');
                    if (localStorageSuccess) {
                        successMsg.innerHTML = '⚠️ <strong>已保存到本地</strong> Google Sheets 提交失败：' + error.message + '。您的数据已保存到浏览器本地存储。';
                        successMsg.style.backgroundColor = '#fff3cd';
                        successMsg.style.color = '#856404';
                        successMsg.style.borderColor = '#ffeaa7';
                    } else {
                        successMsg.innerHTML = '❌ <strong>保存失败</strong> 请重试。';
                        successMsg.style.backgroundColor = '#f8d7da';
                        successMsg.style.color = '#721c24';
                        successMsg.style.borderColor = '#f5c6cb';
                    }
                    successMsg.classList.add('show');
                    
                    // Scroll to top
                    window.scrollTo(0, 0);
                    
                    // Reset form after 5 seconds
                    setTimeout(function() {
                        document.getElementById('surveyForm').reset();
                        successMsg.classList.remove('show');
                        successMsg.style.color = 'green';
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        selectRandomImage();
                        showHideConditional();
                    }, 5000);
                });
            } else {
                // Google Sheets not enabled, just save to localStorage
                try {
                    localStorageSuccess = saveToLocalStorage(data, timestamp);
                    
                    // Show success message
                    var successMsg = document.getElementById('successMessage');
                    successMsg.innerHTML = '⚠️ <strong>已保存到本地</strong> Google Sheets 未启用，您的回复已保存到浏览器本地存储。';
                    successMsg.style.backgroundColor = '#fff3cd';
                    successMsg.style.color = '#856404';
                    successMsg.style.borderColor = '#ffeaa7';
                    successMsg.classList.add('show');
                    
                    // Scroll to top
                    window.scrollTo(0, 0);
                    
                    // Reset form after 3 seconds
                    setTimeout(function() {
                        document.getElementById('surveyForm').reset();
                        successMsg.classList.remove('show');
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        selectRandomImage();
                        showHideConditional();
                    }, 3000);
                } catch (error) {
                    alert('Error saving response: ' + error.message);
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                }
            }
        });
    </script>
</body>
</html>

